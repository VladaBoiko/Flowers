!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},r=t.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},t.parcelRequired7c6=r);const a=document.querySelector("#menu"),l=document.querySelector("#burger");document.querySelector("#header");l&&a&&l.addEventListener("click",(()=>{l.classList.toggle("is-active"),a.classList.toggle("is-active")})),document.querySelectorAll(".menu-link").forEach((e=>{e.addEventListener("click",(()=>{l.classList.remove("is-active"),a.classList.remove("is-active")}))})),window.addEventListener("resize",(()=>{window.innerWidth>=992&&a.classList.contains("is-active")&&a.classList.remove("is-active")}));const s={openMenuBtn:document.querySelector("[data-open-menu-btn]"),closeMenuBtn:document.querySelector("[data-close-menu-btn]"),menu:document.querySelector("[data-personal-menu]"),profileBtn:document.querySelector("[data-pers-btn]"),ordersBtn:document.querySelector("[data-order-btn]"),notifBtn:document.querySelector("[data-notif-btn]"),favBtn:document.querySelector("[data-fav-btn]"),profile:document.querySelector("[data-profile]"),orders:document.querySelector("[data-pers-orders]"),notif:document.querySelector("[data-pers-notif]"),fav:document.querySelector("[data-pers-fav]")};s.openMenuBtn.addEventListener("click",(function(){i.classList.add("visually-hidden"),s.menu.classList.remove("is-hidden"),m(s.openMenuBtn),m(s.closeMenuBtn)})),s.closeMenuBtn.addEventListener("click",u),s.menu.addEventListener("click",(function(e){d(e,s.profile,s.profileBtn),d(e,s.orders,s.ordersBtn),d(e,s.notif,s.notifBtn),d(e,s.fav,s.favBtn)}));let i=document.querySelector(".pers-current-js"),c=document.querySelector(".currentBtn");function d(e,t,n){var o;(function(e,t){return e.target!==t})(e,n)||(!function(e){i.classList.remove("pers-current-js"),i.classList.add("visually-hidden"),i=e,e.classList.remove("visually-hidden"),e.classList.add("pers-current-js"),u()}(t),o=n,c.classList.remove("currentBtn"),c=o,o.classList.add("currentBtn"))}function u(){i.classList.remove("visually-hidden"),s.menu.classList.add("is-hidden"),m(s.openMenuBtn),m(s.closeMenuBtn)}function m(e){e.classList.toggle("is-hidden")}const f={headerUserIcon:document.querySelector("[data-header-user-icon]"),loginForm:document.querySelector("[data-login-form]"),regForm:document.querySelector("[data-reg-form]"),loginSection:document.querySelector("[data-login-section]"),personalCab:document.querySelector("[data-pers-cab-main]"),backdrop:document.querySelector("[data-reg-modal]"),body:document.querySelector("body"),openModalBtn:document.querySelector("[data-reg-modal-open]"),closeModalBtn:document.querySelector("[data-reg-modal-close]"),regSubmitBtn:document.querySelector("[data-submit-reg-btn]"),loginSubmitBtn:document.querySelector("[data-login-btn]"),logoutBtn:document.querySelector("[data-logout-btn]"),loginFormAlertText:document.querySelector("[data-login-alert-text]"),regFormAlertText:document.querySelector("[data-reg-alert-text]"),alertText:document.querySelector("[data-pers-alert-text]"),profileForm:document.querySelector("[data-profile-form]")};function v(){window.removeEventListener("keydown",p),f.body.classList.remove("show-modal"),f.openModalBtn.classList.remove("is-active")}function p(e){"Escape"===e.code&&(v(),f.openModalBtn.blur())}f.openModalBtn.addEventListener("click",(function(){window.addEventListener("keydown",p),f.body.classList.add("show-modal"),f.openModalBtn.classList.add("is-active")})),f.closeModalBtn.addEventListener("click",v),f.backdrop.addEventListener("click",(function(e){e.currentTarget===e.target&&v()}));const y={profileForm:document.querySelector("[data-profile-form]"),notifForm:document.querySelector("[data-pers-notif-form]"),profileFormBtn:document.querySelector("[data-profile-form-btn]"),notifFormBtn:document.querySelector("[data-notif-form-btn]")};function g(e){e.preventDefault()}y.profileForm.addEventListener("submit",(function(e){g(e),y.profileFormBtn.blur()})),y.notifForm.addEventListener("submit",(function(e){g(e),y.notifFormBtn.blur()}));const S=e(r("dIxxU")).create({baseURL:"https://server-flower.herokuapp.com/user"}),L={set(e){S.defaults.headers.common.Authorization=`Bearer ${e}`},unset(){S.defaults.headers.common.Authorization=""}},b=async e=>{try{return await S.post("/signup",e)}catch(e){return e.response.status}},q=async e=>{try{const{data:t}=await S.post("/",e);return L.set(t.token),t}catch(e){return e.response.status}},B=async()=>{try{const{status:e}=await S.get("/");return 204===e&&L.unset(),e}catch(e){return e.response.status}},w=async()=>{try{return await S.get("/validate")}catch(e){return e.response}};function h(e,t){e.textContent=t,e.style.opacity=1,setTimeout((()=>{e.style.opacity=0}),2500)}f.regForm.addEventListener("submit",(function(e){e.preventDefault(),f.regSubmitBtn.blur();const t={name:null,email:null,password:null,confirmPassword:null},{elements:{name:n,email:o,password:r,confirmPassword:a}}=e.currentTarget;if(t.name=n.value,t.email=o.value,t.password=r.value,t.confirmPassword=a.value,""===n.value||""===o.value||""===r.value||""===a.value)return void h(f.regFormAlertText,"Будь ласка, заповніть усі поля");if(r.value!==a.value)return void h(f.regFormAlertText,"Паролі не співпадають, спробуйте ще раз");f.regForm.reset(),v(),async function(e){409===await b(e)?h(f.alertText,"Такий користувач вже зареєстрований"):h(f.alertText,"Для продовження реєстрації, підтвердьте Вашу пошту")}(t)}));let F="token",k="name";function E(e){e.preventDefault(),f.loginSubmitBtn.blur();const t={email:null,password:null},{elements:{email:n,password:o}}=e.currentTarget;t.email=n.value,t.password=o.value,""!==n.value&&""!==o.value?async function(e){const t=await q(e);401===t?h(f.loginFormAlertText,"Електронна пошта або пароль невірні"):(f.loginSection.classList.add("is-hidden"),f.personalCab.classList.remove("is-hidden"),f.headerUserIcon.addEventListener("click",(e=>e.preventDefault())),localStorage.setItem(F,t.token),localStorage.setItem(k,t.name),f.loginForm.reset())}(t):h(f.loginFormAlertText,"Будь ласка, заповніть усі поля")}!function(){if(null===f.loginSection)return;f.loginForm.addEventListener("submit",E)}(),f.logoutBtn.addEventListener("click",(async function(){await B(),localStorage.removeItem(F),localStorage.removeItem("name"),f.loginSection.classList.remove("is-hidden"),f.personalCab.classList.add("is-hidden")})),function(){const e=localStorage.getItem("token");if(null===e)return;L.set(e),async function(){const e=await w();if(401===e)localStorage.removeItem(F);else{localStorage.setItem(F,e.data.token);let t=localStorage.getItem("name");if(null===f.loginSection)return;!function(e){f.loginSection.classList.add("is-hidden"),f.personalCab.classList.remove("is-hidden"),f.profileForm.name.value=e,f.headerUserIcon.addEventListener("click",(e=>e.preventDefault()))}(t)}}()}()}();
//# sourceMappingURL=personal-cabinet.080673da.js.map
