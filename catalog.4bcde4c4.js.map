{"mappings":"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","sources":["src/js/catalog-page.js","src/js/catalog/render.js","src/js/catalog/handleWatchedHistory.js","src/js/catalog/smoothScroll.js"],"sourcesContent":["import { APIGetData } from './catalog/fetch-cards';\nimport { createMarkup, clearData } from './catalog/markup';\nimport { render } from './catalog/render';\nimport { filterData, filterWords } from './catalog/filter';\nimport { smoothScroll } from './catalog/smoothScroll';\n\nimport { reviewsSwiper } from './reviews-slider';\n\nreviewsSwiper.enabled = true;\n\n// import data from '../products.json';\n\nimport getKey from './catalog/getKey';\n\nconst refs = {\n  resetFormBtn: document.querySelector('.filter-catalog__clear-all-btn'),\n  form: document.querySelector('.filter-catalog'),\n  catalogList: document.querySelector('.catalog-list'),\n};\n\nconst catalogData = {\n  selector: refs.catalogList,\n  filterParams: {},\n  page: 1,\n  totalPages: 1,\n  offset: 9,\n  incrementPage() {\n    this.page += 1;\n  },\n  resetPage() {\n    this.page = 1;\n    this.filterParams = {};\n  },\n  async renderData() {\n    try {\n      const data = await APIGetData.getData();\n\n      const filteredData = filterData(data, this.filterParams);\n      filteredData.length <= this.offset && loadMoreBtn.hide();\n      this.totalPages = filteredData.length / this.offset;\n      const slicedData = sliceData(filteredData, this.page, this.offset);\n\n      const markup = createMarkup(slicedData);\n\n      render(refs.catalogList, markup);\n    } catch (error) {\n      console.log(error);\n    }\n  },\n};\n\nfunction getCheckedCheckBox() {\n  const filterData = {\n    category: [],\n    sort: [],\n    color: [],\n    amount: [],\n    size: [],\n    form: [],\n    price: [],\n  };\n  [...refs.form].map(el => {\n    if (el.nodeName === 'INPUT' && el.checked) {\n      const param = el.parentElement.parentElement.previousElementSibling.textContent;\n      const value = el.nextElementSibling.textContent;\n\n      const key = getKey(param, filterWords);\n      const valueFormat = key === 'amount' || key === 'size' ? Number.parseInt(value) : value;\n      filterData[key].indexOf(value) === -1 && filterData[key].push(valueFormat);\n    }\n  });\n  return filterData;\n}\n\nrefs.form.reset();\ncatalogData.renderData();\n\nrefs.resetFormBtn.addEventListener('click', () => {\n  catalogData.resetPage();\n  clearData(refs.catalogList);\n  refs.form.reset();\n  loadMoreBtn.show();\n  loadMoreBtn.enable();\n  catalogData.renderData();\n});\n\nrefs.form.addEventListener('change', () => {\n  clearData(refs.catalogList);\n  catalogData.resetPage();\n  catalogData.filterParams = getCheckedCheckBox();\n  catalogData.renderData();\n  loadMoreBtn.show();\n  loadMoreBtn.enable();\n});\n\nconst loadMoreBtn = {\n  element: document.querySelector('.catalog__btn'),\n  className: 'hidden',\n  disable() {\n    this.element.disabled = true;\n  },\n  enable() {\n    this.element.disabled = false;\n  },\n  hide() {\n    this.element.classList.add(this.className);\n  },\n  show() {\n    this.element.classList.remove(this.className);\n  },\n};\n\nloadMoreBtn.element.addEventListener('click', () => {\n  loadMoreBtn.disable();\n  catalogData.incrementPage();\n  catalogData.renderData();\n  if (catalogData.page >= catalogData.totalPages) {\n    loadMoreBtn.hide();\n  } else {\n    loadMoreBtn.enable();\n  }\n  smoothScroll(refs.catalogList);\n});\n\nfunction sliceData(data, page, offset) {\n  const totalPages = data.length / offset;\n  const start = page * offset - offset;\n  const end = start + offset;\n\n  if (data.length > offset) {\n    if (page < totalPages) {\n      return data.slice(start, end);\n    }\n    return data.slice(start);\n  }\n  return data;\n}\n","import { handleFavorite } from './favoriteHandle';\nimport { handleWatchedHistory } from './handleWatchedHistory';\n\nexport const render = (selector, markup) => {\n  selector.insertAdjacentHTML('beforeend', markup);\n  handleFavorite();\n  handleWatchedHistory();\n};\n","import { saveToLocalStorage, loadFromLocalStorage } from './localStorage';\n\nconst key = 'EarlierWatched';\nconst currentCardId = 'CurrentCardID';\n\nexport function handleWatchedHistory() {\n  const products = document.querySelectorAll('.product');\n\n  products.forEach(product =>\n    product.addEventListener('click', evt => {\n      // console.log(evt.target);\n      event.preventDefault();\n      const productId = product.id;\n      if (\n        !(\n          ((evt.target.nodeName === 'svg' || evt.target.nodeName === 'use') &&\n            evt.target.closest('.product__favorite')) ||\n          evt.target.classList.contains('product__favorite')\n        )\n      ) {\n        saveToLocalStorage(currentCardId, productId);\n      }\n\n      if (productId) {\n        const savedList = loadFromLocalStorage(key);\n\n        if (savedList === 'undefined') {\n          const newList = [productId];\n          saveToLocalStorage(key, newList);\n        } else if (savedList.indexOf(productId) === -1) {\n          savedList.push(productId);\n          saveToLocalStorage(key, savedList);\n        }\n      }\n    })\n  );\n}\n","export function smoothScroll(cardSection) {\n  const { height: cardHeight } = cardSection.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 1 + 10,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$3zrJA","parcelRequire","$dynyT","$3LV0x","$56966dd9ca3fa1fb$var$key","$9b3785105e9d69b8$export$b3890eb0ae9dca99","selector","markup","insertAdjacentHTML","handleFavorite","document","querySelectorAll","forEach","product","addEventListener","evt","event","preventDefault","productId","id","target","nodeName","closest","classList","contains","saveToLocalStorage","savedList","loadFromLocalStorage","newList","indexOf","push","$17def2e6f431bfa7$export$5713088ca0a20ab6","cardSection","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$g0iWm","reviewsSwiper","enabled","$af784749f7559fe0$var$refs","resetFormBtn","querySelector","form","catalogList","$af784749f7559fe0$var$catalogData","filterParams","page","totalPages","offset","incrementPage","this","resetPage","async","data","APIGetData","getData","filteredData","$iDd0l","filterData","length","$af784749f7559fe0$var$loadMoreBtn","hide","slicedData","start","end","slice","$af784749f7559fe0$var$sliceData","$jwgDc","createMarkup","error","console","log","reset","renderData","clearData","show","enable","category","sort","color","amount","size","price","map","el","checked","param","parentElement","previousElementSibling","textContent","value","nextElementSibling","key","$6bmen","default","filterWords","valueFormat","Number","parseInt","$af784749f7559fe0$var$getCheckedCheckBox","element","className","disable","disabled","add","remove"],"version":3,"file":"catalog.4bcde4c4.js.map"}